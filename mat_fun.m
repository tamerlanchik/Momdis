function y=mat_fun(X,Q,N);
T_=X(:,1); X_I=X(:,2:size(X,2)); X_T=X_I(size(X_I,1),:);
J_norm=[1000,1000];
a11=0.7; 
a12=0.3; 
a21=0.3; 
a22=0.7; 
P13=0.7; 
P14=0.7; 
P31=0.5; 
P32=0.7; 
R1=1;    
R2=1;    
R3=1;    
R4=1;    
J(1)=a11*( X_T(3)*X_T(3) - X_T(1)*X_T(1) ) + a12*(X_T(4)*X_T(4) - X_T(2)*X_T(2));
J(2)=a21*( X_T(1)*X_T(1) - X_T(3)*X_T(3) ) + a22*(X_T(2)*X_T(2) - X_T(4)*X_T(4));
if N==0; y=J; else y=J(N); end;
