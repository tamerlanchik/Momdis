function y=Area_3J;
load data_flag_nd;
load data_x0;
load data_r_q;
load data_qmm;
load data_r_set;

max_r_q=[8,8,8]; % Если этот параметр меняется в сторону увеличения, необходимо добавлять циклы по коалициям

% Построение векторов согласно максимальному числу параметров каждой коалиции, равному 8
r_set1=zeros(1,max_r_q(1)); r_set1(1,1:r_q(1))=r_set(1,1:r_q(1));
r_set2=zeros(1,max_r_q(2)); r_set2(1,1:r_q(2))=r_set(1,(r_q(1)+1):(r_q(1)+r_q(2)));
r_set3=zeros(1,max_r_q(3)); r_set3(1,1:r_q(3))=r_set(1,(r_q(1)+r_q(2)+1):(r_q(1)+r_q(2)+r_q(3)));
q_min1=zeros(1,max_r_q(1)); q_min1(1,1:r_q(1))=q_min(1,1:r_q(1));
q_min2=zeros(1,max_r_q(2)); q_min2(1,1:r_q(2))=q_min(1,(r_q(1)+1):(r_q(1)+r_q(2)));
q_min3=zeros(1,max_r_q(3)); q_min3(1,1:r_q(3))=q_min(1,(r_q(1)+r_q(2)+1):(r_q(1)+r_q(2)+r_q(3)));
q_max1=zeros(1,max_r_q(1)); q_max1(1,1:r_q(1))=q_max(1,1:r_q(1));
q_max2=zeros(1,max_r_q(2)); q_max2(1,1:r_q(2))=q_max(1,(r_q(1)+1):(r_q(1)+r_q(2)));
q_max3=zeros(1,max_r_q(3)); q_max3(1,1:r_q(3))=q_max(1,(r_q(1)+r_q(2)+1):(r_q(1)+r_q(2)+r_q(3)));
h_q1=(q_max1-q_min1)./(r_set1-1); for i=1:size(h_q1,2); if h_q1(1,i)==0; h_q1(1,i)=1; end; end;
h_q2=(q_max2-q_min2)./(r_set2-1); for i=1:size(h_q2,2); if h_q2(1,i)==0; h_q2(1,i)=1; end; end;
h_q3=(q_max3-q_min3)./(r_set3-1); for i=1:size(h_q3,2); if h_q3(1,i)==0; h_q3(1,i)=1; end; end;
% Основной этап - циклы по каждому из параметров, начиная с последних в массиве 8х8х8
i=0; i1=0; j3=0; j2=0; tic;
for q18=q_min1(8):h_q1(8):q_max1(8);
for q17=q_min1(7):h_q1(7):q_max1(7);
for q16=q_min1(6):h_q1(6):q_max1(6);
for q15=q_min1(5):h_q1(5):q_max1(5);
for q14=q_min1(4):h_q1(4):q_max1(4);
for q13=q_min1(3):h_q1(3):q_max1(3);
for q12=q_min1(2):h_q1(2):q_max1(2);
for q11=q_min1(1):h_q1(1):q_max1(1);
   i=i+1; j=0;
   i1=i1+1; j1=0; i2=0;
   for q28=q_min2(8):h_q2(8):q_max2(8);
   for q27=q_min2(7):h_q2(7):q_max2(7);
   for q26=q_min2(6):h_q2(6):q_max2(6);
   for q25=q_min2(5):h_q2(5):q_max2(5);
   for q24=q_min2(4):h_q2(4):q_max2(4);
   for q23=q_min2(3):h_q2(3):q_max2(3);
   for q22=q_min2(2):h_q2(2):q_max2(2);
   for q21=q_min2(1):h_q2(1):q_max2(1);
       j=j+1; k=0;
       i2=i2+1; j2=(i-1)*prod(r_set((r_q(1)+r_q(2)+1):sum(r_q))); j3=j3+1; i3=0;
       for q38=q_min3(8):h_q3(8):q_max3(8);
       for q37=q_min3(7):h_q3(7):q_max3(7);
       for q36=q_min3(6):h_q3(6):q_max3(6);
       for q35=q_min3(5):h_q3(5):q_max3(5);
       for q34=q_min3(4):h_q3(4):q_max3(4);
       for q33=q_min3(3):h_q3(3):q_max3(3);
       for q32=q_min3(2):h_q3(2):q_max3(2);
       for q31=q_min3(1):h_q3(1):q_max3(1);
           k=k+1; j1=j1+1; j2=j2+1; i3=i3+1;
           q_1=[q11,q12,q13,q14,q15,q16,q17,q18];
           q_2=[q21,q22,q23,q24,q25,q26,q27,q28];
           q_3=[q31,q32,q33,q34,q35,q36,q37,q38];
           q=[q_1(1,1:r_q(1)),q_2(1,1:r_q(2)),q_3(1,1:r_q(3))];
           x=mat_int(q,x0); J=mat_fun(x,q,0);
           DataM.Q(i,j,k,:)=q; DataM.J(i,j,k,:)=J;
           J1=[J(1),J(2)+J(3)]; Data1.Q(i1,j1,:)=q; Data1.J(i1,j1,:)=J1;
           J2=[J(2),J(1)+J(3)]; Data2.Q(i2,j2,:)=q; Data2.J(i2,j2,:)=J2;
           J3=[J(3),J(1)+J(2)]; Data3.Q(i3,j3,:)=q; Data3.J(i3,j3,:)=J3;
      set(findobj(RassOblPok, 'Tag', 'textVObPok') , 'String', num2str([i,j,k]));
%      [i,j,k]
       end;
       end;
       end;
       end;
       end;
       end;
       end;
       end;
   end;
   end;
   end;
   end;
   end;
   end;
   end;
   end;
end;
end;
end;
end;
end;
end;
end;
end;
DataM.Time=toc;
% Построение области значений показателей и запись матриц в mat-файл
S_=size(DataM.Q); S_m=prod(S_(1,1:3));
Data0.Q=zeros(S_m,size(DataM.Q,4)); Data0.J=zeros(S_m,size(DataM.J,4)); ss=0;
for i=1:S_(1);
 for j=1:S_(2);
  for k=1:S_(3);
    ss=ss+1;
    for l=1:size(Data0.Q,4); Data0.Q(ss,l)=DataM.Q(i,j,k,l); end;
    for l=1:size(Data0.J,4); Data0.J(ss,l)=DataM.J(i,j,k,l); end;
  end;
 end;
end;
save data_field Data0 Data1 Data2 Data3 DataM;
plot3(Data0.J(:,1),Data0.J(:,2),Data0.J(:,3),'b.'); hold on; grid on;
